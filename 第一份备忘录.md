# 🚀 OpenClaw 内网部署与 AI 协同进化纪实

> **记录时间**：2026-02-28  
> **协作背景**：在 CentOS 7 停止维护（EOL）的背景下，通过人机协作攻克部署难题。

---

## 📝 1. 协作总结：为什么记录这个时刻？

我在安装部署 Docker 的时候遇到一个非常老旧的问题：**CentOS 7 源过老**。
AI 敏锐地发现了这是一个经典的“坑”——由于官方已于 2024 年 6 月停止维护，常规源已全部 404。

我选择记录下这个时刻，并同步到 Github。由于目前 OpenClaw 还没有协同上，所以我让他生成代码，先直接粘贴到 Github。下面是我粘贴的内容，先看看效果如何。

---

## 🚨 2. 关键转折：解决 CentOS 7 停更 404 报错

当系统抛出大量 `HTTP Error 404` 时，AI 立即诊断出必须切换到 **Vault（档案馆）源**。这是整个部署能够继续进行的前提。

### 【修复系统源操作】

1. **备份陈旧源**：
   `sudo mv /etc/yum.repos.d/*.repo /etc/yum.repos.d/bak/`

2. **配置存档源 (直接执行下方整段代码)**：

```bash
sudo tee /etc/yum.repos.d/CentOS-Base.repo <<EOF
[base]
name=CentOS-7-Base-Vault
baseurl=[http://mirrors.aliyun.com/centos-vault/7.9.2009/os/x86_64/](http://mirrors.aliyun.com/centos-vault/7.9.2009/os/x86_64/)
gpgcheck=1
gpgkey=[http://mirrors.aliyun.com/centos-vault/RPM-GPG-KEY-CentOS-7](http://mirrors.aliyun.com/centos-vault/RPM-GPG-KEY-CentOS-7)

[updates]
name=CentOS-7-Updates-Vault
baseurl=[http://mirrors.aliyun.com/centos-vault/7.9.2009/updates/x86_64/](http://mirrors.aliyun.com/centos-vault/7.9.2009/updates/x86_64/)
gpgcheck=1
gpgkey=[http://mirrors.aliyun.com/centos-vault/RPM-GPG-KEY-CentOS-7](http://mirrors.aliyun.com/centos-vault/RPM-GPG-KEY-CentOS-7)
EOF
```

3. **刷新缓存**：
   `sudo yum clean all && sudo yum makecache`

---

## 📦 3. 核心技术栈部署

### 3.1 Docker 环境安装
```bash
# 1. 安装基础依赖
sudo yum install -y yum-utils device-mapper-persistent-data lvm2

# 2. 添加 Docker 社区仓库
sudo yum-config-manager --add-repo [http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo](http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo)

# 3. 安装与启动服务
sudo yum install -y docker-ce docker-ce-cli containerd.io
sudo systemctl start docker && sudo systemctl enable docker
```

### 3.2 Docker Compose 安装 (Mac OSX 协作优化)
```bash
sudo curl -L "[https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname](https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname) -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose
```

---

## 🚀 4. OpenClaw 部署配置 (预览版)

```yaml
version: '3.3'
services:
  mysql:
    image: mysql:8.0
    container_name: openclaw-db
    environment:
      MYSQL_ROOT_PASSWORD: your_password
      MYSQL_DATABASE: openclaw
    volumes:
      - ./data/mysql:/var/lib/mysql

  redis:
    image: redis:alpine
    container_name: openclaw-redis

  openclaw:
    image: openclaw/openclaw:latest
    container_name: openclaw-app
    ports:
      - "8080:8080"
    environment:
      - DB_HOST=mysql
      - DB_USER=root
      - DB_PASS=your_password
      - REDIS_HOST=redis
    depends_on:
      - mysql
      - redis
```

---

## 📈 5. AI 进化观察实录

通过这次实战，我观察到 AI 在处理极端环境下的进化特质：

* **诊断力**：精准识别 2026 年环境下操作停更系统的必然冲突，而非盲目让用户重试网络。
* **适应力**：在 Markdown 嵌套发生渲染截断时，能迅速切换防截断的输出策略。
* **协同力**：将一次枯燥的报错排查，转化为协助建立具备叙事感与技术存档价值的文档记录。

---

**记录人：User & Gemini AI Collaborator**
